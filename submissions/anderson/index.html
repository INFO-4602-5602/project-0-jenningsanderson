<html>
<head>
<title>Project 0</title>
<link rel="stylesheet" href="project0.css"></link>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<!--Put your D3 import statement between these two lines-->
  <script src="https://d3js.org/d3.v3.min.js"></script>
<!--Put your D3 import statement between these two lines-->
</head>

<body>
	<div id="partOne">
    <h1>Part One: </h1>
	</div>

  <div id="partTwo">
    <h1>Part Two: </h1>
    <div id="barchart">
    </div>
	</div>

  <div id="partThree">
    <h1>Part Three &amp; Four: </h1>
    <div id="scatterplot">
      <p id="scatterLabel"></p>
    </div>
	</div>

  <div id="partFive">
    <h1>Part Five: </h1>
    <div id="scatterplotSet">
      <svg id="sm_1"></svg>
      <svg id="sm_2"></svg>
      <svg id="sm_3"></svg>
      <svg id="sm_4"></svg>
    </div>
  </div>

  <script type="text/javascript">
      var datasets = [
        {'path': 'data/anscombe_i.csv',
         'title': "Anscombe I"},
        {'path': 'data/anscombe_ii.csv',
         'title': "Anscombe II"},
        {'path': 'data/anscombe_iii.csv',
         'title': "Anscombe III"},
        {'path': 'data/anscombe_iv.csv',
         'title': "Anscombe IV"}
      ]

      // Put your part one code here ***********************
      datasets.forEach(function(item, idx){
        d3.csv(item.path, function(data){
          checkDataset(data)
        })
      })

      // Leave this to test your data uploading. All data uploading should be above this line
      function checkDataset(dataset) {
        if (dataset.length == 11)
          $("#partOne").append("<p>data loaded correctly</p>");
        else
          $("#partOne").append("<p>data loaded incorrectly. Try using the debugger to help you find the bug!</p>");
      }

      // Put your part two code here ***********************

      d_idx = Math.floor((Math.random() * 4));

      console.log("Loading dataset: " + datasets[d_idx].path)

      //Hide all variables inside this function so it doesn't affect other plots
      d3.csv(datasets[d_idx].path,function(data){
        // Get the data into working form
        data.forEach(function(d,idx){
          d.x = +d.x;
          d.idx = idx;
        })

        //Using https://bl.ocks.org/mbostock/3885304 as starting "block" ... :)
        var height  = 400,
            width   = 600,
            padding = {top: 10, right: 10, bottom: 30, left: 30},
            margin  = 10,
            svg = d3.select("#barchart").append("svg:svg")
              .attr("width", width)
						  .attr("height",height);

        var xScale = d3.scale.linear()
						.domain([0,data.length])
						.range([padding.left+margin, width-padding.right-margin])

      	var yScale = d3.scale.linear()
						.domain([0, d3.max(data, function(d){return d.x})])
						.range([height - padding.bottom-margin, padding.top+margin])

        var xAxis = d3.svg.axis()
            .scale(xScale)
            .orient("bottom")
            .ticks(5);

        var xAsisG = svg.append("g")
            .attr('class','axis')
            .attr('transform','translate(0, '+ (height - padding.bottom) +")")
            .call(xAxis)

        var yAxis = d3.svg.axis()
            .scale(yScale)
            .orient("left")
            .ticks(5);

        var yAsisG = svg.append("g")
            .attr('class','axis')
            .attr('transform','translate('+ padding.left +",0)")
            .call(yAxis)

        svg.append("g").selectAll(".bar")
         .data(data)
           .enter().append("rect")
            .attr("class", "bar")
            .attr("x", function(d) { return xScale(d.idx); })
            .attr("y", function(d) { return yScale(d.x) })
            .attr("height", function(d) { return height - padding.bottom - margin - yScale(d.x); })
            .attr("width", 20)

                    // var xLabel = svg.append("text")
                    //     .attr('class','label')
                    //     .attr('transform','translate('+ (width/2 + padding.left) + ', '+ (height-padding.bottom/2) +")")
                    //     .attr('text-anchor','start')
                    //     .text("X Label")
        // var yLabel = svg.append("text")
        //     .attr('class','label')
        //     .attr('x',margin)
        //     .attr('y',h/2)
        //     // .attr('transform','rotate(270)')
        //     .text("Frequency")

      })

      // Put your part three & four code here ***********************
      d3.csv(datasets[d_idx].path,function(data){
        // Get the data into working form
        data.forEach(function(d,idx){
          d.x = +d.x;
          d.y = +d.y;
        })

        var height  = 400,
            width   = 600,
            padding = {top: 10, right: 10, bottom: 30, left: 30},
            margin  = 10,
            svg = d3.select("#scatterplot").append("svg:svg")
              .attr("width", width)
              .attr("height",height);

        var xScale = d3.scale.linear()
            .domain([0,d3.max(data, function(d){return d.x})])
            .range([padding.left+margin, width-padding.right-margin])

        var yScale = d3.scale.linear()
            .domain([0, d3.max(data, function(d){return d.y})])
            .range([height - padding.bottom-margin, padding.top+margin])

        var xAxis = d3.svg.axis()
            .scale(xScale)
            .orient("bottom")
            .ticks(5);

        var xAsisG = svg.append("g")
            .attr('class','axis')
            .attr('transform','translate(0, '+ (height - padding.bottom) +")")
            .call(xAxis)

        var yAxis = d3.svg.axis()
            .scale(yScale)
            .orient("left")
            .ticks(5);

        var yAsisG = svg.append("g")
            .attr('class','axis')
            .attr('transform','translate('+ padding.left +",0)")
            .call(yAxis)

  	    point = svg.selectAll('.point') // Select elements
  		    .data(data);		// Bind data to elements

  	    point.enter().append('svg:circle');	// Create new elements if needed

      	// Update our selection
      	point
      		.attr('class', 'point')									// Give it a class
      		.attr('cx', function(d) { return xScale(d.x); })	// x-coordinate
      		.attr('cy', function(d) { return yScale(d.y); })	// y-coordinate
      		.style('fill','green')
      		.attr('r', 0)
      		.attr('r', 8);

        point.append('svg:title')									// tooltip
      	 	.text(function(d) { return d.x; });


        //Part 4: Interaction
        point.on("click",function(d){
          document.getElementById("scatterLabel").innerHTML = d.x
        });

        point.on("mouseover",function(d){
          this.style = "fill: yellow;"
        });

        point.on("mouseout",function(d){
          this.style = "fill: green;"
        });

                    // var xLabel = svg.append("text")
                    //     .attr('class','label')
                    //     .attr('transform','translate('+ (width/2 + padding.left) + ', '+ (height-padding.bottom/2) +")")
                    //     .attr('text-anchor','start')
                    //     .text("X Label")
        // var yLabel = svg.append("text")
        //     .attr('class','label')
        //     .attr('x',margin)
        //     .attr('y',h/2)
        //     // .attr('transform','rotate(270)')
        //     .text("Frequency")

      })
      // Put your part five code here ***********************
      var padding = {top: 10, right: 10, bottom: 30, left: 30},
          margin  = 5

      var sm = {height: 250, width: 300}

      datasets.forEach(function(item, idx){
        d3.csv(item.path, function(data){

          data.forEach(function(d,idx){
            d.x = +d.x;
            d.y = +d.y;
          })

          var svg = d3.select("#sm_"+(idx+1))
              svg.attr("width",  sm.width)
              svg.attr("height", sm.height)
              svg.style("float","left");

          var xScale = d3.scale.linear()
              .domain([0,d3.max(data, function(d){return d.x})])
              .range([padding.left+margin, sm.width-padding.right-margin])

          var yScale = d3.scale.linear()
              .domain([0, d3.max(data, function(d){return d.y})])
              .range([sm.height - padding.bottom-margin, padding.top+margin])

          var xAxis = d3.svg.axis()
              .scale(xScale)
              .orient("bottom")
              .ticks(5);

          var xAsisG = svg.append("g")
              .attr('class','axis')
              .attr('transform','translate(0, '+ (sm.height - padding.bottom) +")")
              .call(xAxis)

          var yAxis = d3.svg.axis()
              .scale(yScale)
              .orient("left")
              .ticks(5);

          var yAsisG = svg.append("g")
              .attr('class','axis')
              .attr('transform','translate('+ padding.left +",0)")
              .call(yAxis)

          point = svg.selectAll('.point') // Select elements
            .data(data);		// Bind data to elements

          point.enter().append('svg:circle');	// Create new elements if needed

          // Update our selection
          point
            .attr('class', 'point')									// Give it a class
            .attr('cx', function(d) { return xScale(d.x); })	// x-coordinate
            .attr('cy', function(d) { return yScale(d.y); })	// y-coordinate
            .style('fill','green')
            .attr('r', 0)
            .attr('r', 5);

          var xLabel = svg.append("text")
              .attr('class','label')
              .attr('transform','translate('+ (sm.width/2) + ', '+ (padding.top) +")")
              .text(item.title)
        })
      })


  </script>
</body>


</html>
